<html>
<head>
    <title>fmp - {{ playing.basename }}</title>
    {% include "head.html"  ignore missing %}
</head>
<body>
    {% include "search-form.html" ignore missing %}
    {% include "rating-tpl.html" ignore missing %}

    <script type="text/html" id="tpl-search">
        <div class="ui-input-search ui-btn-corner-all ui-btn-shadow ui-icon-searchfield ui-body-c">
            <%- text %>
        </div>
    </script>
    <div id="file-box"></div>
    
    <input type="range" name="volume-slider" data-theme="d" data-highlight="true" id="volume-slider" value="60" min="0" max="100" step="1" />

    <input type="range" name="seek-slider" data-theme="d" data-highlight="true" id="seek-slider" value="0" min="0" max="100" step="1000000000" />

    <!--
    <pre id="debugs">
        <h1>Conductor Playing Model</h1>
        <ul id="conductorPlayingModelDebug"></ul>
    </pre>
    -->

    <script type="text/javascript">
        $(document).bind('pageinit', function(){
            var playerData = {
                    "player": {{ player.to_dict()|tojson|safe }}, 
                    "playing": {{ playing.to_full_dict()|tojson|safe }},
                    "volume": {{ volume|tojson|safe }},
                    "extended": {{ extended|tojson|safe }}
                };
            try {
                var testModel = new TestModel(playerData);
            } catch(e) {
                alert("TestModel"+e);
                return;
            }
            try {
                var conductor = new ConductorModel(playerData);
            } catch(e) {
                alert("Conductor error:"+e);
                return;
            }
            var fileview = new PlayingFileView({
                    "el": "#file-box",
                    "conductor": conductor
                }).render();
            var volumeView = new SliderView({
                "el": "#volume-slider",
                "model": conductor.volume
            }).render();
            var posView = new TimeSlider({
                "el": "#seek-slider",
                "model": conductor.pos
            }).render(); 
            var controlView = new ControlView({
                "el": "#player-control",
                "conductor": conductor
            }).render();
            var timeStatusView = new TimeStatusView({
                "el": "#time-status",
                "conductor": conductor
            }).render();
            /*
            var conductorDebugView = new ModelDebugView({
                "el": "#conductorPlayingModelDebug",
                "model": conductor.playing
            }).render(); */
        });
    </script>
    <pre id="logger"></pre>
</body>
</html>
