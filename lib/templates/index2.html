<html>
<head>
    <title>fmp - {{ playing.basename }}</title>
    {% include "head.html"  ignore missing %}
</head>
<body>
    {% include "search-form.html" ignore missing %}
    {% include "rating-tpl.html" ignore missing %}
    

    <script type="text/html" id="tpl-search">
        <div class="ui-input-search ui-btn-corner-all ui-btn-shadow ui-icon-searchfield ui-body-c">
            <%- text %>
        </div>
    </script>
    <div id="player-control"></div>
    <div id="file-box"></div>
    <input type="range" name="volume-slider" data-theme="d" data-highlight="true" id="volume-slider" value="60" min="0" max="100" step="1" />

    <input type="range" name="seek-slider" data-theme="d" data-highlight="true" id="seek-slider" value="0" min="0" max="100" step="1000000000" />

    <script type="text/javascript">
        $(document).ready(function(){
            var mediaPlayerModel = new MediaPlayerModel({
                    player: {{ player.to_dict()|tojson|safe }}, 
                    playing: {{ playing.to_full_dict()|tojson|safe }},
                    volume: {{ volume|tojson|safe }}
                }),
                fileView = new FileView({
                    "el": "#file-box",
                    "model": mediaPlayerModel.playingModel,
                    "showAddToPreload": false
                }), 
                mediaControlView = new MediaControlView({
                    "el": "#player-control",
                    "playerModel": mediaPlayerModel.playerModel
                });
            fileView.render();
            mediaControlView.render();
            mediaPlayerModel.playerModel.on('change:artist_title', function(){
                window.document.title = "fmp - " + mediaPlayerModel.playerModel.get('artist_title');
            });
            var volumeView = new SliderView({
                "el": "#volume-slider",
                "model": mediaPlayerModel.volumeModel
            }).render();
            var posView = new SliderView({
                "el": "#seek-slider",
                "model": mediaPlayerModel.posModel
            }).render();

        });
    </script>
</body>
</html>
